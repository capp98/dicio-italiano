<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Dicion√°rio Italiano</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body class="conteudo exercicio">
    <form onsubmit="getWord()">
      <input id="word" type="text" />
      <input type="submit" value="Pesquisar" />
    </form>

    <div id="ui"></div>

    <script>
      const form = document.forms[0];
      form.addEventListener('submit', (e) => e.preventDefault());

      var proxy = 'https://cors-anywhere.herokuapp.com/';
      var parser = new DOMParser();

      function createCORSRequest(word) {
        var xhr = new XMLHttpRequest();
        var url =
          proxy +
          `https://www.dizionario-italiano.it/dizionario-italiano.php?parola=${word}`;

        if ('withCredentials' in xhr) {
          xhr.open('get', url, true);
        } else if (typeof XDomainRequest != 'undefined') {
          xhr = new XDomainRequest();
          xhr.open(method, url);
        } else {
          xhr = null;
        }
        return xhr;
      }

      function getWord(e) {
        console.log('Pesquisando');

        let word = document.getElementById('word').value;

        var request = createCORSRequest(word);
        request.send();

        request.onload = function () {
          var xmlDocument = new DOMParser().parseFromString(
            request.response,
            'text/html'
          );

          let definicoes = xmlDocument.querySelectorAll('.italiano');

          let element = document.createElement('div');
          let hd = document.createElement('h1');
          hd.innerText = word;
          element.append(hd);
          definicoes.forEach((definicao, index) => {
            let p = document.createElement('p');
            p.innerText = index + '. ' + definicao.innerHTML;
            element.append(p);
          });

          document.getElementById('ui').prepend(element);
        };
      }
    </script>
  </body>
</html>
